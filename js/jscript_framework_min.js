function JsCalendar(e,t,n,r,i){if(r=="True"){cal=Calendar.setup({selectionType:Calendar.SEL_MULTIPLE,bottomBar:false})}else{cal=Calendar.setup({showTime:24,onSelect:function(){this.hide()}})}if(i!="")cal.selection.set(Calendar.dateToInt(new Date(i)));cal.manageFields(e,t,n)}function MostrarPagina(e,t,n){if(n==undefined||n==0){$("#loading").overlay().load()}var r=crearXMLHttpRequest();r.open("GET",e,true);r.onreadystatechange=function(){if(r.readyState==4){var e=r.responseText.extractScript();document.getElementById(t).innerHTML=r.responseText;e.evalScript();if(n==undefined||n==0){$("#loading").overlay().close()}}};r.send(null)}function MostrarPeticion(e){var t=crearXMLHttpRequest();t.open("GET",e,true);t.onreadystatechange=function(){if(t.readyState==4){var e=t.responseText.extractScript();e.evalScript()}};t.send(null)}function PopUpPeticion(e){var t=crearXMLHttpRequest();t.open("GET",e,true);t.onreadystatechange=function(){if(t.readyState==4){var e=t.responseText.extractScript();Ver_PopUp(t.responseText);e.evalScript()}};t.send(null)}function UpdatePanel(e,t){var n=crearXMLHttpRequest();n.open("GET",e,true);n.onreadystatechange=function(){if(n.readyState==4){var e=n.responseText.extractScript();document.getElementById(t).innerHTML=n.responseText;e.evalScript()}};n.send(null);SetDocInnerHTML(t,'<img src="../../img/ajax-loader.gif" width="16px" height="16px" alt="Cargando"/>')}function UpdateValue(e,t){var n=crearXMLHttpRequest();n.open("GET",e,true);n.onreadystatechange=function(){if(n.readyState==4){document.getElementById(t).value=n.responseText}};n.send(null)}function Carga_Js(e){var t=document.createElement("script");t.type="text/javascript";t.src=e;document.body.appendChild(t)}function DocValue(e){var t=document.getElementById(e);if(t)return t.value;else return""}function DocInnerText(e){var t=document.getElementById(e);if(t)return t.innerText;else return""}function DocInnerHTML(e){var t=document.getElementById(e);if(t)return t.innerHTML;else return""}function SelectText(e){var t=document.getElementById(e);if(t.selectedIndex==-1)return"";else return t.options[t.selectedIndex].text;delete t}function SelectIndex(e,t){document.getElementById(e).selectedIndex=t}function SelectContains(e,t){var n=document.getElementById(e),r=n.options.length;for(var i=0;i<r;i++){if(n.options[i].value==t){return true}}return false}function Visualizar(e,t){document.getElementById(e).style.visibility=t}function AutoDisplay(e){var t=document.getElementById(e);if(t.style.display=="")t.style.display="none";else t.style.display=""}function Display(e,t){try{document.getElementById(e).style.display=t}catch(n){}}function CountRows(e){return document.getElementById(e).tBodies[0].rows.length}function CountBodyRows(e){return e.rows.length}function Exists(e){return document.getElementById(e)}function SetDocValue(e,t){document.getElementById(e).value=t}function SetDocInnerHTML(e,t){document.getElementById(e).innerHTML=t}function SetDocInnerText(e,t){document.getElementById(e).innerText=t}function SetClass(e,t){document.getElementById(e).className=t}function Create_Element(e,t,n){var r=document.getElementById(e);var i=document.createElement(t);i.id=n;r.appendChild(i)}function Delete_Element(e,t){if(document.getElementById(t))document.getElementById(e).removeChild(document.getElementById(t))}function QuitarElemento(e,t){if(Exists(t)){document.getElementById(t).innerHTML="";document.getElementById(e).removeChild(document.getElementById(t))}}function ImgMouseOver(e,t){e.src="../img/"+t}function ImgMouseOut(e,t){e.src="../img/"+t}function ReadOnlyControl(e,t){document.getElementById(e).readOnly=t}function DisabledControl(e,t){document.getElementById(e).disabled=t}function PadLeft(e,t,n){for(var r=e.toString().length;r<n;r++){e=t+e}return e}function Focus(e){document.getElementById(e).focus()}function SoloNumerico(e){tecla=document.all?e.keyCode:e.which;if(tecla==8)return true;patron=/^[0-9]$/;te=String.fromCharCode(tecla);return patron.test(te)}function SoloDecimal(e,t){tecla=document.all?e.keyCode:e.which;if(tecla==8)return true;patron=/^[0-9]*\.?[0-9]*$/;te=String.fromCharCode(tecla);return patron.test(t+te)}function SoloUrl(e){tecla=document.all?e.keyCode:e.which;if(tecla==33||tecla==34||tecla==35||tecla==36||tecla==37||tecla==38||tecla==39||tecla==40||tecla==41||tecla==42||tecla==43||tecla==47||tecla==58||tecla==61||tecla==63||tecla==64||tecla==91||tecla==92||tecla==93||tecla==95||tecla==46||tecla==123||tecla==125)return false;else return true}function getElementsByClassName(e,t){if(!t)t=document.getElementsByTagName("body")[0];var n=[],r=new RegExp("\\b"+e+"\\b"),i=t.getElementsByTagName("*"),s=i.length;for(var o=0,u=s;o<u;o++)if(r.test(i[o].className))n.push(i[o]);return n}function BtnClick(e){try{if(ie){Obj(e).click()}else{Obj(e).onclick()}}catch(t){alert(t.message)}}function BtnMouseDown(e){Obj(e).onmousedown()}function Select_Todochk(e,t){var n=document.getElementById(e).tBodies[0],r=CountBodyRows(n),i=1,s;for(var o=0;o<r;o++){if(!n.rows[o].className.match(/\bnopaginacion\b/)){if(n.rows[o].className.indexOf("no_display")==-1){s=document.getElementById("chk_"+e+"_"+i);if(s)s.checked=t}i++}}}function Ver_Archivo(e){window.open(e,"_blank")}function Mostrar_BarraInfo(e){if(e)SetClass("Barra_info","barra_info_exito");else SetClass("Barra_info","barra_info_error");$("#Barra_info").animate({height:"30px"},1e3);notificacion=setTimeout(function(){Ocultar_Barra_info()},5e3)}function Ocultar_Barra_info(){$("#Barra_info").animate({height:"0px"},1e3,"linear",function(){Display("Barra_info","none")})}function Ver_PopUp(e){if(e!=""){var t=Obj("exposeMask");if(t){if(t.style.display=="none"){SetDocInnerHTML("PopUp",e);$("#PopUp").overlay().load();t.tabIndex=0;t.style.width=document.body.scrollWidth+"px";Obj("exposeMask").style.zIndex=100;Obj("PopUp").style.zIndex=101}else{t.tabIndex+=1;var n=t.cloneNode(false);n.id=n.id+""+t.tabIndex;n.style.zIndex=parseInt(t.style.zIndex,10)+2+t.tabIndex*2;Obj("master").appendChild(n);n.style.display="";var r=Obj("PopUp").cloneNode(false);r.id=r.id+""+t.tabIndex;r.style.zIndex=parseInt(n.style.zIndex,10)+1;Obj("master").appendChild(r);r.innerHTML=e.replace(/@/g,t.tabIndex);r.style.left=(screen.width-r.childNodes[0].childNodes[0].width)/2+"px";delete n;delete r}}else{SetDocInnerHTML("PopUp",e);$("#PopUp").overlay().load();t=Obj("exposeMask");t.tabIndex=0;t.style.width=document.body.scrollWidth+"px";Obj("exposeMask").style.zIndex=100;Obj("PopUp").style.zIndex=101}e.evalScript()}else{Ver_Mensaje("Atención","Lo sentimos, ocurrió un error al presentar la información.<br/>Por favor, inténtelo nuevamente.<br/>Si el problema persiste comuníquese con nuestra Mesa de Ayuda.")}}function Cerrar_PopUp(e){if(e==undefined||e=="PopUp@"){var t=getElementsByClassName("overlay"),n=t.length;if(t[0].id!="PopUp"){if(n>0){if(n>1)t.sort(OrderByTabIndexDesc);Obj("exposeMask").tabindex-=1;QuitarElemento("master",t[0].id);QuitarElemento("master",t[0].id.replace(/PopUp/,"exposeMask"))}else{$("#PopUp").overlay().close();SetDocInnerHTML("PopUp","")}}else{$("#PopUp").overlay().close();SetDocInnerHTML("PopUp","")}}else{Obj("exposeMask").tabindex-=1;QuitarElemento("master",e);QuitarElemento("master",e.replace(/PopUp/,"exposeMask"))}}function Ver_Mensaje(e,t,n,r){Ver_PopUp("<div class='panel'><table cellpadding='0' cellspacing='0' width='"+(r==undefined||r==""?"400":r)+"' class='panel_borde'><tr class='panel_title'><td valign='middle' style='height:23px;width:100%;padding-left:10px;padding-right:5px;'><div style='float:left;'> "+e+"</div><div style='float:right;'><div class='cerrar' onmousedown='Cerrar_PopUp(\"PopUp@\");' style='float:right;'> </div></div></td></tr><tr><td class='panel_texto'>"+t+(n!=undefined?"<br/><div class='btnfinales'>"+n+"   <input type='button' value='Cerrar' onclick='Cerrar_PopUp(\"PopUp@\")' alt='Cerrar' title='Cerrar' /></div>":"")+"</td></tr></table></div>")}function Cargar_Combo(e,t,n,r,i,s){var o=r.split("|"),u=o.length,a="";for(var f=0;f<u;f++){a+=DocValue(o[f])+"|"}if(a.length>0)a=a.substring(0,a.length-1);UpdatePanel("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+a+(s!=undefined?"|"+s:""),i)}function Cargar_Objeto(e,t,n,r,i,s){var o=n.split("|"),u=o.length,a="";for(var f=0;f<u;f++){a+=DocValue(o[f])+"|"}if(a.length>0)a=a.substring(0,a.length-1);if(s=="panel"){UpdatePanel("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+a+(r!=undefined&&a.length==0?r:r!=undefined?"|"+r:""),i)}else if(s=="value"){UpdateValue("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+a+(r!=undefined&&a.length==0?r:r!=undefined?"|"+r:""),i)}else if(s=="custom"){MostrarPeticion("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+a+(r!=undefined&&a.length==0?r:r!=undefined?"|"+r:"")+"&div="+i)}}function Cargar_Input(e,t,n,r,i,s){var o=r.split("|"),u=o.length,a="";for(var f=0;f<u;f++){a+=DocValue(o[f])+"|"}if(a.length>0)a=a.substring(0,a.length-1);UpdateValue("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+a+(s!=undefined?"|"+s:""),i)}function Buscar_Grilla(e,t,n,r,i,s){MostrarPagina("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+(r!=""?r+(n!=""?"|":""):"")+Recupera_Datos(n),i,s)}function Operacion(e,t,n,r){if(Valida_Datos(n)==0){MostrarPeticion("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+(r!=""?r+(n!=""?"|":""):"")+Recupera_Datos(n))}}function Exportar_Excel(){document.getElementById("frmExcel").submit()}function Operacion_Reload(e,t,n,r,i){if(Valida_Datos(n)==0){UpdatePanel("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+(r!=""?r+(n!=""?"|":""):"")+Recupera_Datos(n),i);Operacion_Result(true,0)}}function Operacion_Result(e,t){if(e){SetDocInnerHTML("td_Barra_info","La operación se realizó satisfactoriamente");if(t==undefined||t==1){Cerrar_PopUp()}}else SetDocInnerHTML("td_Barra_info","La operacidón no se pudo realizar satisfactoriamente");Mostrar_BarraInfo(e)}function PopUp(e,t,n,r){if(Valida_Datos(n)==0){PopUpPeticion("../../code/bc/bc_"+e+".php?opc="+t+"&prm="+(r!=""?r+(n!=""?"|":""):"")+Recupera_Datos(n))}}function Recupera_Datos(e){if(e=="")return"";var t=new Array("input","textarea","select"),n=[],r=document.getElementById(e),i,s,o="";for(var u=0;u<3;u++){i=r.getElementsByTagName(t[u]);s=i.length;for(var a=0;a<s;a++){if(i[a].id.startsWith("fil_"))n.push(i[a])}}n.sort(OrderByTabIndex);s=n.length;for(var u=0;u<s;u++)o+=Recupera_Datos_Item(n[u]);if(o.length>0)return o.substring(0,o.length-1);else return o}function Recupera_Datos_Item(e){switch(e.type){case"checkbox":if(e.id.indexOf("fil_gcol_")==0){return e.checked+"~"}else if(e.id.indexOf("fil_gcolchk_")==0){if(e.checked)return e.value+"~"}else if(e.id.indexOf("fil_grow_")==0){return e.checked+"_"}else if(e.id.indexOf("fil_growchk_")==0){if(e.checked)return e.value+"_"}else if(e.id.indexOf("fil_chk_")==0){if(e.checked)return e.value+"|"}else{return e.checked+"|"};case"radio":if(e.checked)return RadioValue(e.getAttribute("name"))+"|";else return"";case"select-multiple":return SelectValue(e.id).toString().replace(/,/g,"^")+"|";case"textarea":return e.value.replace(/\n/g,"<br>")+"|";default:if(e.id.indexOf("fil_gcol_")==0){return e.value+"~"}else if(e.id.indexOf("fil_grow_")==0){return e.value+"_"}else if(e.id.indexOf("fil_multi_")==0){return Recuperar_Keys_ListBox(e.id).join("^")+"|"}else{return e.value+"|"}}}function Recuperar_Keys_ListBox(e){var t=document.getElementById(e),n=t.options.length,r=new Array;for(var i=0;i<n;i++){r.push([t.options[i].value])}return r}function Recuperar_Datos_ListBox(e){var t=document.getElementById(e),n=t.options.length,r=new Array;for(var i=0;i<n;i++){r.push([t.options[i].value,t.options[i].text])}return r}function OrderByTabIndex(e,t){if(parseInt(e.getAttribute("posicion"))>parseInt(t.getAttribute("posicion")))return 1;else if(parseInt(e.getAttribute("posicion"))<parseInt(t.getAttribute("posicion")))return-1;else return 0}function OrderByTabIndexDesc(e,t){if(parseInt(t.getAttribute("posicion"))>parseInt(e.getAttribute("posicion")))return 1;else if(parseInt(t.getAttribute("posicion"))<parseInt(e.getAttribute("posicion")))return-1;else return 0}function Valida_Datos(tabla){if(tabla!=""){var i=0,tagname=new Array("input","select"),id_filtros=[],b,count,validacion;for(i=0;i<2;i++){b=document.getElementById(tabla).getElementsByTagName(tagname[i]);count=b.length;for(var j=0;j<count;j++){if(b[j].getAttribute("validacion")!=null){id_filtros.push(b[j])}}}id_filtros.sort(OrderByTabIndex);count=id_filtros.length;for(i=0;i<count;i++){validacion=id_filtros[i].getAttribute("validacion").split("|||");if(validacion[0].length>0){if(!eval(validacion[0])){Valida_Datos_Msj(validacion[1],tabla);return 1}}}if(Exists("error_"+tabla))Display("error_"+tabla,"none");return 0}return 0}function Valida_Datos_Msj(e,t,n){if(n=="false"||n==undefined){if(!Exists("error_"+t)){var r=document.getElementById(t).tBodies[0];var i=document.createElement("tr");var s=document.createElement("td");s.id="error_"+t;s.className="error";s.setAttribute("colSpan",4);s.style.cssText="padding-left:5px;padding-bottom:5px";i.appendChild(s);r.appendChild(i)}SetDocInnerText("error_"+t,"Nota: "+e);Display("error_"+t,"")}else{Ver_Mensaje(e)}}function Mover_Paginacion(e,t){if(Obj(t+"_pagant")){var n=parseInt(DocValue(e+"_PagActual"),10),r=n+7,i=n-7,s=document,o=[],u=document.getElementById("paginacion_"+e).getElementsByTagName("span");count=u.length;for(var a=0;a<count;a++){if(u[a].id.startsWith(t+"_pag_"))o.push(u[a])}count=o.length;if(r>=count){document.getElementById(t+"_pagant").style.display="none"}else document.getElementById(t+"_pagant").style.display="";if(i>1){document.getElementById(t+"_pagprev").style.display=""}else document.getElementById(t+"_pagprev").style.display="none";for(var f=0;f<count;f++){if(f+1>=i&&f+1<=r)o[f].style.display="";else o[f].style.display="none"}}}function Paginacion(e,t,n,r,i){var s=document,o=0,u=0,a=DocValue(t+"_PagActual"),f=s.getElementById(t).tBodies[0],l=CountBodyRows(f),c=0,h="";for(o=0;o<l;o++){c++}var p=parseFloat(c)/i,d=0,v=0;if(r==0){if(e>p)e=Math.ceil(p);u=e}else u=parseInt(a,10)+r;s.getElementById(n+"_pag_"+u).className="link linkpaginacionactual";s.getElementById(n+"_pag_"+a).className="link linkpaginacion";var m=i*u,g;for(o=0;o<l;o++){g=f.rows[v];if(v>=m-i&&v<m){g.className=g.className.replace(/no_display/g,"");d++}else g.className+=" no_display";v++}SetDocValue(t+"_PagActual",u);if(u!=1){Visualizar(t+"_tab_first","visible");Visualizar(t+"_tab_left","visible")}else{Visualizar(t+"_tab_first","hidden");Visualizar(t+"_tab_left","hidden")}if(u>=c/i){Visualizar(t+"_tab_right","hidden");Visualizar(t+"_tab_last","hidden")}else{Visualizar(t+"_tab_right","visible");Visualizar(t+"_tab_last","visible")}if(u==1)h=u*i-i+1+" - "+d*u;else h=u*i-i+1+" - "+((u-1)*i+d);s.getElementById(t+"_Titulo_numeracion").innerText=h+" de "+c;Mover_Paginacion(t,n)}function Delete_Row(e){e.parentNode.parentNode.deleteRow(e.rowIndex)}function Upload_Result(e,t,n,r){var i="";if(t==0){i=" El Archivo se ha subido correctamente";SetDocValue(e,n)}else if(t==1)i="Error ! - El Archivo no llego al servidor";else if(t==2)i="Error ! - El tipo de Archivo no es permitido";else if(t==3)i="Error ! - No se pudo copiar Archivo. Posible problema de permisos en servidor";Obj("divUpload_mensaje_"+e).innerHTML=i}function Grilla_Imprimir(e){var t=DocInnerHTML(e),n=0,r=0,i="";do{n=t.toLowerCase().indexOf("<script>");if(n>0){r=t.toLowerCase().indexOf("</script>")+9;i=t.substring(n,r);t=t.replace(i,"")}}while(n>0);var s=window.open("about:blank",e.replace(/./g).replace(/_/g),"resizable=1,scrollbars=1");s.document.writeln("<html><head>");s.document.writeln('<script language="JavaScript1.1">document.oncontextmenu = function () { return false };</script>');s.document.writeln('<style type="text/css">');s.document.writeln(".tituloTablaResultado{ background-color:#E0E0E0;font-family:Segoe UI, Tahoma;font-size:12px;color:#4D6185;font-weight:bold;height:25px;}");s.document.writeln(".tituloTablaCelda{ border-bottom:2px solid #F3F3EF; }");s.document.writeln(".toolboxTablaResultado{ background-color:#E0E0E0;font-family:Segoe UI, Tahoma;font-size:12px;color:#4D6185;font-weight:bold;height:25px;text-align:right;}");s.document.writeln(".toolboxTablaCelda{ padding-left:10px; }");s.document.writeln(".cabeceraTablaResultado{ background-color:#F3F3EF;font-family:Segoe UI, Tahoma;font-size:12px;color:#4D6185;font-weight:bold;height:30px;}");s.document.writeln(".filaTablaResultado{ padding:3px;border-bottom:solid #0087B6 1px;font-size:12px; }");s.document.writeln(".textoData{font-family:Segoe UI, Tahoma;font-size:13px;color:#4D6185;text-decoration:none;}");s.document.writeln(".no_print{display: none;}");s.document.writeln(".no_display{display: none;}");s.document.writeln(".center{text-align:center;}");s.document.writeln(".left{text-align:center;}");s.document.writeln(".right{text-align:right;}");s.document.writeln("</style></head><body>");s.document.writeln("<img src='../../img/logo.jpg' width='179px' height='95px' />");var o=new Date;s.document.writeln("<h3>Emitido: "+o.getDate()+"/"+PadLeft(o.getMonth()+1,"0",2)+"/"+o.getFullYear()+" "+o.getHours()+":"+PadLeft(o.getMinutes(),"0",2)+"</h3>");s.document.writeln("<h4>Imprimir: <button onclick='window.print()' style='height:18px'><span style='font-size:10px'>Ok</span></button></h4>");s.document.writeln(t);s.document.writeln("</body></html>");s.document.close();s.focus();var u=s.document.getElementsByTagName("input");count=u.length;for(j=0;j<count;j++)u[j].disabled=true}Calendar=function(){function e(t){t=t||{};this.args=t=V(t,{animation:!s,cont:null,bottomBar:true,date:true,fdow:j("fdow"),min:null,max:null,reverseWheel:false,selection:[],selectionType:e.SEL_SINGLE,weekNumbers:false,align:"Bl/ / /T/r",inputField:null,trigger:null,dateFormat:"%Y-%m-%d",opacity:i?1:3,titleFormat:"%b %Y",showTime:false,timePos:"right",time:true,minuteStep:5,disabled:ct,dateInfo:ct,onChange:ct,onSelect:ct,onTimeChange:ct,onFocus:ct,onBlur:ct});this.handlers={};var n=this,r=new Date;t.min=W(t.min);t.max=W(t.max);if(t.date===true){t.date=r}if(t.time===true){t.time=r.getHours()*100+Math.floor(r.getMinutes()/t.minuteStep)*t.minuteStep}this.date=W(t.date);this.time=t.time;this.fdow=t.fdow;lt("onChange onSelect onTimeChange onFocus onBlur".split(/\s+/),function(e){var r=t[e];if(!(r instanceof Array)){r=[r]}n.handlers[e]=r});this.selection=new e.Selection(t.selection,t.selectionType,_,this);var o=y.call(this);if(t.cont){ht(t.cont).appendChild(o)}if(t.trigger){this.manageFields(t.trigger,t.inputField,t.dateFormat)}}function l(e){var t=["<table",f,"><tr>"],n=0;if(e.args.weekNumbers){t.push("<td><div class='DynarchCalendar-weekNumber'>",j("wk"),"</div></td>")}while(n<7){var r=(n++ +e.fdow)%7;t.push("<td><div",j("weekend").indexOf(r)>=0?" class='DynarchCalendar-weekend'>":">",j("sdn")[r],"</div></td>")}t.push("</tr></table>");return t.join("")}function c(e,t,n){t=t||e.date;n=n||e.fdow;t=new Date(t);var r=t.getMonth(),i=[],s=0,o=e.args.weekNumbers;t.setDate(1);var u=(t.getDay()-n)%7;if(u<0){u+=7}t.setDate(-u);t.setDate(t.getDate()+1);var a=new Date,l=a.getDate(),c=a.getMonth(),h=a.getFullYear();i[s++]="<table class='DynarchCalendar-bodyTable'"+f+">";for(var p=0;p<6;++p){i[s++]="<tr class='DynarchCalendar-week";if(p==0){i[s++]=" DynarchCalendar-first-row"}if(p==5){i[s++]=" DynarchCalendar-last-row"}i[s++]="'>";if(o){i[s++]="<td class='DynarchCalendar-first-col'><div class='DynarchCalendar-weekNumber'>"+F(t)+"</div></td>"}for(var d=0;d<7;++d){var v=t.getDate(),m=t.getMonth(),g=t.getFullYear(),y=1e4*g+100*(m+1)+v,b=e.selection.isSelected(y),w=e.isDisabled(t);i[s++]="<td class='";if(d==0&&!o){i[s++]=" DynarchCalendar-first-col"}if(d==0&&p==0){e._firstDateVisible=y}if(d==6){i[s++]=" DynarchCalendar-last-col";if(p==5){e._lastDateVisible=y}}if(b){i[s++]=" DynarchCalendar-td-selected"}i[s++]="'><div dyc-type='date' unselectable='on' dyc-date='"+y+"' ";if(w){i[s++]="disabled='1' "}i[s++]="class='DynarchCalendar-day";if(j("weekend").indexOf(t.getDay())>=0){i[s++]=" DynarchCalendar-weekend"}if(m!=r){i[s++]=" DynarchCalendar-day-othermonth"}if(v==l&&m==c&&g==h){i[s++]=" DynarchCalendar-day-today"}if(w){i[s++]=" DynarchCalendar-day-disabled"}if(b){i[s++]=" DynarchCalendar-day-selected"}w=e.args.dateInfo(t);if(w&&w.klass){i[s++]=" "+w.klass}i[s++]="'>"+v+"</div></td>";t.setDate(v+1)}i[s++]="</tr>"}i[s++]="</table>";return i.join("")}function h(e){var t=["<table class='DynarchCalendar-topCont'",f,"><tr><td><div class='DynarchCalendar'>",!i?"<button class='DynarchCalendar-focusLink'></button>":"<a class='DynarchCalendar-focusLink' href='#'></a>","<div class='DynarchCalendar-topBar'><div dyc-type='nav' dyc-btn='-Y' dyc-cls='hover-navBtn,pressed-navBtn' class='DynarchCalendar-navBtn DynarchCalendar-prevYear'><div></div></div><div dyc-type='nav' dyc-btn='+Y' dyc-cls='hover-navBtn,pressed-navBtn' class='DynarchCalendar-navBtn DynarchCalendar-nextYear'><div></div></div><div dyc-type='nav' dyc-btn='-M' dyc-cls='hover-navBtn,pressed-navBtn' class='DynarchCalendar-navBtn DynarchCalendar-prevMonth'><div></div></div><div dyc-type='nav' dyc-btn='+M' dyc-cls='hover-navBtn,pressed-navBtn' class='DynarchCalendar-navBtn DynarchCalendar-nextMonth'><div></div></div><table class='DynarchCalendar-titleCont'",f,"><tr><td><div dyc-type='title' dyc-btn='menu' dyc-cls='hover-title,pressed-title' class='DynarchCalendar-title'>",p(e),"</div></td></tr></table><div class='DynarchCalendar-dayNames'>",l(e),"</div></div><div class='DynarchCalendar-body'></div>"];if(e.args.bottomBar||e.args.showTime){t.push("<div class='DynarchCalendar-bottomBar'>",m(e),"</div>")}t.push("<div class='DynarchCalendar-menu' style='display: none'>",d(e),"</div><div class='DynarchCalendar-tooltip'></div></div></td></tr></table>");return t.join("")}function p(e){return"<div unselectable='on'>"+z(e.date,e.args.titleFormat)+"</div>"}function d(e){var t=["<table height='100%'",f,"><tr><td><table style='margin-top: 1.5em'",f,"><tr><td colspan='3'><input dyc-btn='year' class='DynarchCalendar-menu-year' size='6' value='",e.date.getFullYear(),"' /></td></tr><tr><td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='today'>",j("goToday"),"</div></td></tr></table><p class='DynarchCalendar-menu-sep'> </p><table class='DynarchCalendar-menu-mtable'",f,">"],n=j("smn"),r=0,i=t.length,s;while(r<12){t[i++]="<tr>";for(s=4;--s>0;){t[i++]="<td><div dyc-type='menubtn' dyc-cls='hover-navBtn,pressed-navBtn' dyc-btn='m"+r+"' class='DynarchCalendar-menu-month'>"+n[r++]+"</div></td>"}t[i++]="</tr>"}t[i++]="</table></td></tr></table>";return t.join("")}function v(e,t){t.push("<table class='DynarchCalendar-time'"+f+"><tr><td rowspan='2'><div dyc-type='time-hour' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-hour'></div></td><td dyc-type='time-hour+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td><td rowspan='2' class='DynarchCalendar-time-sep'></td><td rowspan='2'><div dyc-type='time-min' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-minute'></div></td><td dyc-type='time-min+' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-up'></td>");if(e.args.showTime==12){t.push("<td rowspan='2' class='DynarchCalendar-time-sep'></td><td rowspan='2'><div class='DynarchCalendar-time-am' dyc-type='time-am' dyc-cls='hover-time,pressed-time'></div></td>")}t.push("</tr><tr><td dyc-type='time-hour-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td><td dyc-type='time-min-' dyc-cls='hover-time,pressed-time' class='DynarchCalendar-time-down'></td></tr></table>")}function m(e){function r(){if(n.showTime){t.push("<td>");v(e,t);t.push("</td>")}}var t=[],n=e.args;t.push("<table",f," style='width:100%'><tr>");if(n.timePos=="left"){r()}if(n.bottomBar){t.push("<td>");t.push("<table",f,"><tr><td><div dyc-btn='today' dyc-cls='hover-bottomBar-today,pressed-bottomBar-today' dyc-type='bottomBar-today' class='DynarchCalendar-bottomBar-today'>",j("today"),"</div></td></tr></table>");t.push("</td>")}if(n.timePos=="right"){r()}t.push("</tr></table>");return t.join("")}function y(){var e=Z("div"),t=this.els={},n={mousedown:tt(C,this,true),mouseup:tt(C,this,false),mouseover:tt(O,this,true),mouseout:tt(O,this,false),keypress:tt(H,this)};n[o?"DOMMouseScroll":"mousewheel"]=tt(M,this);if(i){n.dblclick=n.mousedown;n.keydown=n.keypress}e.innerHTML=h(this);nt(e.firstChild,function(e){var n=g[e.className];if(n){t[n]=e}if(i){e.setAttribute("unselectable","on")}});$(t.main,n);$([t.focusLink,t.yearInput],this._focusEvents={focus:tt(b,this),blur:tt(E,this)});this.moveTo(this.date,false);this.setTime(null,true);return t.topCont}function b(){if(this._bluringTimeout){clearTimeout(this._bluringTimeout)}this.focused=true;G(this.els.main,"DynarchCalendar-focused");this.callHooks("onFocus",this)}function w(){this.focused=false;Q(this.els.main,"DynarchCalendar-focused");if(this._menuVisible){N(this,false)}if(!this.args.cont){this.hide()}this.callHooks("onBlur",this)}function E(){this._bluringTimeout=setTimeout(tt(w,this),50)}function S(e){switch(e){case"time-hour+":this.setHours(this.getHours()+1);break;case"time-hour-":this.setHours(this.getHours()-1);break;case"time-min+":this.setMinutes(this.getMinutes()+this.args.minuteStep);break;case"time-min-":this.setMinutes(this.getMinutes()-this.args.minuteStep);break;default:return}}function T(e,t,n){if(this._bodyAnim){this._bodyAnim.stop()}var r;if(t!=0){r=new Date(e.date);r.setDate(1);switch(t){case"-Y":case-2:r.setFullYear(r.getFullYear()-1);break;case"+Y":case 2:r.setFullYear(r.getFullYear()+1);break;case"-M":case-1:r.setMonth(r.getMonth()-1);break;case"+M":case 1:r.setMonth(r.getMonth()+1);break}}else{r=new Date}return e.moveTo(r,!n)}function N(e,t){e._menuVisible=t;Y(t,e.els.title,"DynarchCalendar-pressed-title");var n=e.els.menu;if(s){n.style.height=e.els.main.offsetHeight+"px"}if(!e.args.animation){ot(n,t);if(e.focused){e.focus()}}else{if(e._menuAnim){e._menuAnim.stop()}var r=e.els.main.offsetHeight;if(s){n.style.width=e.els.topBar.offsetWidth+"px"}if(t){n.firstChild.style.marginTop=-r+"px";e.args.opacity>0&&st(n,0);ot(n,true)}e._menuAnim=rt({onUpdate:function(i,s){n.firstChild.style.marginTop=s(it.accel_b(i),-r,0,!t)+"px";e.args.opacity>0&&st(n,s(it.accel_b(i),0,.85,!t))},onStop:function(){e.args.opacity>0&&st(n,.85);n.firstChild.style.marginTop="";e._menuAnim=null;if(!t){ot(n,false);if(e.focused){e.focus()}}}})}}function C(t,n){n=n||window.event;var r=L(n);if(r&&!r.getAttribute("disabled")){var s=r.getAttribute("dyc-btn"),o=r.getAttribute("dyc-type"),u=r.getAttribute("dyc-date"),a=this.selection,f,l={mouseover:K,mousemove:K,mouseup:function(e){var t=r.getAttribute("dyc-cls");if(t){Q(r,A(t,1))}clearTimeout(f);J(document,l,true);l=null}};if(t){setTimeout(tt(this.focus,this),1);var c=r.getAttribute("dyc-cls");if(c){G(r,A(c,1))}if("menu"==s){this.toggleMenu()}else{if(r&&/^[+-][MY]$/.test(s)){if(T(this,s)){var h=tt(function(){if(T(this,s,true)){f=setTimeout(h,40)}else{l.mouseup();T(this,s)}},this);f=setTimeout(h,350);$(document,l,true)}else{l.mouseup()}}else{if("year"==s){this.els.yearInput.focus();this.els.yearInput.select()}else{if(o=="time-am"){$(document,l,true)}else{if(/^time/.test(o)){var h=tt(function(e){S.call(this,e);f=setTimeout(h,100)},this,o);S.call(this,o);f=setTimeout(h,350);$(document,l,true)}else{if(u&&a.type){if(a.type==e.SEL_MULTIPLE){if(n.shiftKey&&this._selRangeStart){a.selectRange(this._selRangeStart,u)}else{if(!n.ctrlKey&&!a.isSelected(u)){a.clear(true)}a.set(u,true);this._selRangeStart=u}}else{a.set(u);this.moveTo(R(u),2)}r=this._getDateDiv(u);O.call(this,true,{target:r})}$(document,l,true)}}}}}if(i&&l&&/dbl/i.test(n.type)){l.mouseup()}if(/^(DynarchCalendar-(topBar|bottomBar|weekend|weekNumber|menu(-sep)?))?$/.test(r.className)&&!this.args.cont){l.mousemove=tt(k,this);this._mouseDiff=ut(n,at(this.els.topCont));$(document,l,true)}}else{if("today"==s){if(!this._menuVisible&&a.type==e.SEL_SINGLE){a.set(new Date)}this.moveTo(new Date,true);N(this,false)}else{if(/^m([    0-9]+)/.test(s)){var u=new Date(this.date);u.setDate(1);u.setMonth(RegExp.$1);u.setFullYear(this._getInputYear());this.moveTo(u,true);N(this,false)}else{if(o=="time-am"){this.setHours(this.getHours()+12)}}}}if(!i){K(n)}}}function k(e){e=e||window.event;var t=this.els.topCont.style,n=ut(e,this._mouseDiff);t.left=n.x+"px";t.top=n.y+"px"}function L(e){var t=e.target||e.srcElement,n=t;while(t&&t.getAttribute&&!t.getAttribute("dyc-type")){t=t.parentNode}return t.getAttribute&&t||n}function A(e,t){return"DynarchCalendar-"+e.split(/,/)[t]}function O(e,t){t=t||window.event;var n=L(t);if(n){var r=n.getAttribute("dyc-type");if(r&&!n.getAttribute("disabled")){if(!e||!this._bodyAnim||r!="date"){var i=n.getAttribute("dyc-cls");i=i?A(i,0):"DynarchCalendar-hover-"+r;if(r!="date"||this.selection.type){Y(e,n,i)}if(r=="date"){Y(e,n.parentNode.parentNode,"DynarchCalendar-hover-week");this._showTooltip(n.getAttribute("dyc-date"))}if(/^time-hour/.test(r)){Y(e,this.els.timeHour,"DynarchCalendar-hover-time")}if(/^time-min/.test(r)){Y(e,this.els.timeMinute,"DynarchCalendar-hover-time")}Q(this._getDateDiv(this._lastHoverDate),"DynarchCalendar-hover-date");this._lastHoverDate=null}}}if(!e){this._showTooltip()}}function M(e){e=e||window.event;var t=L(e);if(t){var n=t.getAttribute("dyc-btn"),r=t.getAttribute("dyc-type"),i=e.wheelDelta?e.wheelDelta/120:-e.detail/3;i=i<0?-1:i>0?1:0;if(this.args.reverseWheel){i=-i}if(/^(time-(hour|min))/.test(r)){switch(RegExp.$1){case"time-hour":this.setHours(this.getHours()+i);break;case"time-min":this.setMinutes(this.getMinutes()+this.args.minuteStep*i);break}K(e)}else{if(/Y/i.test(n)){i*=2}T(this,-i);K(e)}}}function _(){this.refresh();var e=this.inputField,t=this.selection;if(e){var n=t.print(this.dateFormat);/input|textarea/i.test(e.tagName)?e.value=n:e.innerHTML=n;e.onchange()}this.callHooks("onSelect",this,t)}function H(t){if(this._menuAnim){return}t=t||window.event;var n=t.target||t.srcElement,r=n.getAttribute("dyc-btn"),i=t.keyCode,s=t.charCode||i,o=D[i];if("year"==r&&i==13){var u=new Date(this.date);u.setDate(1);u.setFullYear(this._getInputYear());this.moveTo(u,true);N(this,false);return K(t)}if(this._menuVisible){if(i==27){N(this,false);return K(t)}}else{if(!t.ctrlKey){o=null}if(o==null&&!t.ctrlKey){o=P[i]}if(i==36){o=0}if(o!=null){T(this,o);return K(t)}s=String.fromCharCode(s).toLowerCase();var a=this.els.yearInput,f=this.selection;if(s==" "){N(this,true);this.focus();a.focus();a.select();return K(t)}if(s>="0"&&s<="9"){N(this,true);this.focus();a.value=s;a.focus();return K(t)}var l=j("mn"),c=t.shiftKey?-1:this.date.getMonth(),h=0,p;while(++h<12){p=l[(c+h)%12].toLowerCase();if(p.indexOf(s)==0){var u=new Date(this.date);u.setDate(1);u.setMonth((c+h)%12);this.moveTo(u,true);return K(t)}}if(i>=37&&i<=40){var u=this._lastHoverDate;if(!u&&!f.isEmpty()){u=i<39?f.getFirstDate():f.getLastDate();if(u<this._firstDateVisible||u>this._lastDateVisible){u=null}}if(!u){u=i<39?this._lastDateVisible:this._firstDateVisible}else{var d=u;u=R(u);var c=100;while(c-->0){switch(i){case 37:u.setDate(u.getDate()-1);break;case 38:u.setDate(u.getDate()-7);break;case 39:u.setDate(u.getDate()+1);break;case 40:u.setDate(u.getDate()+7);break}if(!this.isDisabled(u)){break}}u=q(u);if(u<this._firstDateVisible||u>this._lastDateVisible){this.moveTo(u)}}Q(this._getDateDiv(d),G(this._getDateDiv(u),"DynarchCalendar-hover-date"));this._lastHoverDate=u;return K(t)}if(i==13){if(this._lastHoverDate){if(f.type==e.SEL_MULTIPLE&&(t.shiftKey||t.ctrlKey)){if(t.shiftKey&&this._selRangeStart){f.clear(true);f.selectRange(this._selRangeStart,this._lastHoverDate)}if(t.ctrlKey){f.set(this._selRangeStart=this._lastHoverDate,true)}}else{f.reset(this._selRangeStart=this._lastHoverDate)}return K(t)}}if(i==27&&!this.args.cont){this.hide()}}}function B(e,t){return e.replace(/\$\{([^:\}]+)(:[^\}]+)?\}/g,function(e,n,r){var i=t[n],s;if(r){s=r.substr(1).split(/\s*\|\s*/);i=(i>=s.length?s[s.length-1]:s[i]).replace(/##?/g,function(e){return e.length==2?"#":i})}return i})}function j(e,t){var n=a.__.data[e];if(t&&typeof n=="string"){n=B(n,t)}return n}function F(e){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0);var t=e.getDay();e.setDate(e.getDate()-(t+6)%7+3);var n=e.valueOf();e.setMonth(0);e.setDate(4);return Math.round((n-e.valueOf())/(7*864e5))+1}function I(e){e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0);var t=new Date(e.getFullYear(),0,1,12,0,0);var n=e-t;return Math.floor(n/864e5)}function q(e){if(e instanceof Date){return 1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate()}if(typeof e=="string"){return parseInt(e,10)}return e}function R(e,t,n,r,i){if(!(e instanceof Date)){e=parseInt(e,10);var s=Math.floor(e/1e4);e=e%1e4;var o=Math.floor(e/100);e=e%100;e=new Date(s,o-1,e,t||12,n||0,r||0,i||0)}return e}function U(e,t,n){var r=e.getFullYear(),i=e.getMonth(),s=e.getDate(),o=t.getFullYear(),u=t.getMonth(),a=t.getDate();return r<o?-3:r>o?3:i<u?-2:i>u?2:n?0:s<a?-1:s>a?1:0}function z(e,t){var n=e.getMonth(),r=e.getDate(),i=e.getFullYear(),s=F(e),o=e.getDay(),u=e.getHours(),a=u>=12,f=a?u-12:u,l=I(e),c=e.getMinutes(),h=e.getSeconds(),p=/%./g,d;if(f===0){f=12}d={"%a":j("sdn")[o],"%A":j("dn")[o],"%b":j("smn")[n],"%B":j("mn")[n],"%C":1+Math.floor(i/100),"%d":r<10?"0"+r:r,"%e":r,"%H":u<10?"0"+u:u,"%I":f<10?"0"+f:f,"%j":l<10?"00"+l:l<100?"0"+l:l,"%k":u,"%l":f,"%m":n<9?"0"+(1+n):1+n,"%o":1+n,"%M":c<10?"0"+c:c,"%n":"\n","%p":a?"PM":"AM","%P":a?"pm":"am","%s":Math.floor(e.getTime()/1e3),"%S":h<10?"0"+h:h,"%t":"	","%U":s<10?"0"+s:s,"%W":s<10?"0"+s:s,"%V":s<10?"0"+s:s,"%u":o+1,"%w":o,"%y":(""+i).substr(2,2),"%Y":i,"%%":"%"};return t.replace(p,function(e){return d.hasOwnProperty(e)?d[e]:e})}function W(e){if(e){if(typeof e=="number"){return R(e)}if(!(e instanceof Date)){var t=e.split(/-/);return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10),12,0,0,0)}}return e}function X(e){function t(t){for(var n=t.length;--n>=0;){if(t[n].toLowerCase().indexOf(e)==0){return n}}}e=e.toLowerCase();var n=t(j("smn"))||t(j("mn"));if(n!=null){n++}return n}function V(e,t,n,r){r={};for(n in t){if(t.hasOwnProperty(n)){r[n]=t[n]}}for(n in e){if(e.hasOwnProperty(n)){r[n]=e[n]}}return r}function $(e,t,n,r){if(e instanceof Array){for(var s=e.length;--s>=0;){$(e[s],t,n,r)}}else{if(typeof t=="object"){for(var s in t){if(t.hasOwnProperty(s)){$(e,s,t[s],n)}}}else{if(e.addEventListener){e.addEventListener(t,n,i?true:!!r)}else{if(e.attachEvent){e.attachEvent("on"+t,n)}else{e["on"+t]=n}}}}}function J(e,t,n,r){if(e instanceof Array){for(var s=e.length;--s>=0;){J(e[s],t,n)}}else{if(typeof t=="object"){for(var s in t){if(t.hasOwnProperty(s)){J(e,s,t[s],n)}}}else{if(e.removeEventListener){e.removeEventListener(t,n,i?true:!!r)}else{if(e.detachEvent){e.detachEvent("on"+t,n)}else{e["on"+t]=null}}}}}function K(e){e=e||window.event;if(i){e.cancelBubble=true;e.returnValue=false}else{e.preventDefault();e.stopPropagation()}return false}function Q(e,t,n){if(e){var r=e.className.replace(/^\s+|\s+$/,"").split(/\x20/),i=[],s;for(s=r.length;s>0;){if(r[--s]!=t){i.push(r[s])}}if(n){i.push(n)}e.className=i.join(" ")}return n}function G(e,t){return Q(e,t,t)}function Y(e,t,n){if(t instanceof Array){for(var r=t.length;--r>=0;){Y(e,t[r],n)}}else{Q(t,n,e?n:null)}return e}function Z(e,t,n){var r=null;if(document.createElementNS){r=document.createElementNS("http://www.w3.org/1999/xhtml",e)}else{r=document.createElement(e)}if(t){r.className=t}if(n){n.appendChild(r)}return r}function et(e,t){if(t==null){t=0}var n,r,i;try{n=Array.prototype.slice.call(e,t)}catch(s){n=new Array(e.length-t);for(r=t,i=0;r<e.length;++r,++i){n[i]=e[r]}}return n}function tt(e,t){var n=et(arguments,2);return t==undefined?function(){return e.apply(this,n.concat(et(arguments)))}:function(){return e.apply(t,n.concat(et(arguments)))}}function nt(e,t){if(!t(e)){for(var n=e.firstChild;n;n=n.nextSibling){if(n.nodeType==1){nt(n,t)}}}}function rt(e,t,n){function r(e,t,n,r){return r?n+e*(t-n):t+e*(n-t)}function s(){if(t){o()}n=0;t=setInterval(u,1e3/e.fps)}function o(){if(t){clearInterval(t);t=null}e.onStop(n/e.len,r)}function u(){var t=e.len;e.onUpdate(n/t,r);if(n==t){o()}++n}e=V(e,{fps:50,len:15,onUpdate:ct,onStop:ct});if(i){e.len=Math.round(e.len/2)}s();return{start:s,stop:o,update:u,args:e,map:r}}function st(e,t){if(t===""){i?e.style.filter="":e.style.opacity=""}else{if(t!=null){i?e.style.filter="alpha(opacity="+t*100+")":e.style.opacity=t}else{if(!i){t=parseFloat(e.style.opacity)}else{if(/alpha\(opacity=([0-9.])+\)/.test(e.style.opacity)){t=parseFloat(RegExp.$1)/100}}}}return t}function ot(e,t){var n=e.style;if(t!=null){n.display=t?"":"none"}return n.display!="none"}function ut(e,t){var n=i?e.clientX+document.body.scrollLeft:e.pageX;var r=i?e.clientY+document.body.scrollTop:e.pageY;if(t){n-=t.x;r-=t.y}return{x:n,y:r}}function at(e){var t=0,n=0,r=/^div$/i.test(e.tagName),i,s;if(r&&e.scrollLeft){t=e.scrollLeft}if(r&&e.scrollTop){n=e.scrollTop}i={x:e.offsetLeft-t,y:e.offsetTop-n};if(e.offsetParent){s=at(e.offsetParent);i.x+=s.x;i.y+=s.y}return i}function ft(){var e=document.documentElement,t=document.body;return{x:e.scrollLeft||t.scrollLeft,y:e.scrollTop||t.scrollTop,w:e.clientWidth||window.innerWidth||t.clientWidth,h:e.clientHeight||window.innerHeight||t.clientHeight}}function lt(e,t,n){for(n=0;n<e.length;++n){t(e[n])}}function ht(e){if(typeof e=="string"){e=document.getElementById(e)}return e}var t=navigator.userAgent,n=/opera/i.test(t),r=/Konqueror|Safari|KHTML/i.test(t),i=/msie/i.test(t)&&!n&&!/mac_powerpc/i.test(t),s=i&&/msie 6/i.test(t),o=/gecko/i.test(t)&&!r&&!n&&!i,u=e.prototype,a=e.I18N={};e.SEL_NONE=0;e.SEL_SINGLE=1;e.SEL_MULTIPLE=2;e.SEL_WEEK=3;e.dateToInt=q;e.intToDate=R;e.printDate=z;e.formatString=B;e.i18n=j;e.LANG=function(e,t,n){a.__=a[e]={name:t,data:n}};e.setup=function(t){return new e(t)};u.moveTo=function(e,t){e=W(e);var n=U(e,this.date,true),r,i=this.args,s=i.min&&U(e,i.min),o=i.max&&U(e,i.max);if(!i.animation){t=false}Y(s!=null&&s<=1,[this.els.navPrevMonth,this.els.navPrevYear],"DynarchCalendar-navDisabled");Y(o!=null&&o>=-1,[this.els.navNextMonth,this.els.navNextYear],"DynarchCalendar-navDisabled");if(s<-1){e=i.min;r=1;n=0}if(o>1){e=i.max;r=2;n=0}this.date=e;this.refresh(!!t);this.callHooks("onChange",this,e,t);if(t&&!(n==0&&t==2)){if(this._bodyAnim){this._bodyAnim.stop()}var u=this.els.body,a=Z("div","DynarchCalendar-animBody-"+x[n],u),f=u.firstChild,l=st(f)||.7,h=r?it.brakes:n==0?it.shake:it.accel_ab2,p=n*n>4,d=p?f.offsetTop:f.offsetLeft,v=a.style,m=p?u.offsetHeight:u.offsetWidth;if(n<0){m+=d}else{if(n>0){m=d-m}else{m=Math.round(m/7);if(r==2){m=-m}}}if(!r&&n!=0){var g=a.cloneNode(true),y=g.style,b=2*m;g.appendChild(f.cloneNode(true));y[p?"marginTop":"marginLeft"]=m+"px";u.appendChild(g)}f.style.visibility="hidden";a.innerHTML=c(this);this._bodyAnim=rt({onUpdate:tt(function(e,t){var i=h(e);if(g){var s=t(i,m,b)+"px"}if(r){v[p?"marginTop":"marginLeft"]=t(i,m,0)+"px"}else{if(p||n==0){v.marginTop=t(n==0?h(e*e):i,0,m)+"px";if(n!=0){y.marginTop=s}}if(!p||n==0){v.marginLeft=t(i,0,m)+"px";if(n!=0){y.marginLeft=s}}}if(this.args.opacity>2&&g){st(g,1-i);st(a,i)}},this),onStop:tt(function(t){u.innerHTML=c(this,e);this._bodyAnim=null},this)})}this._lastHoverDate=null;return s>=-1&&o<=1};u.isDisabled=function(e){var t=this.args;return t.min&&U(e,t.min)<0||t.max&&U(e,t.max)>0||t.disabled(e)};u.toggleMenu=function(){N(this,!this._menuVisible)};u.refresh=function(e){var t=this.els;if(!e){t.body.innerHTML=c(this)}t.title.innerHTML=p(this);t.yearInput.value=this.date.getFullYear()};u.redraw=function(){var e=this.els;this.refresh();e.dayNames.innerHTML=l(this);e.menu.innerHTML=d(this);if(e.bottomBar){e.bottomBar.innerHTML=m(this)}nt(e.topCont,tt(function(t){var n=g[t.className];if(n){e[n]=t}if(t.className=="DynarchCalendar-menu-year"){$(t,this._focusEvents);e.yearInput=t}else{if(i){t.setAttribute("unselectable","on")}}},this));this.setTime(null,true)};u.setLanguage=function(t){var n=e.setLanguage(t);if(n){this.fdow=n.data.fdow;this.redraw()}};e.setLanguage=function(e){var t=a[e];if(t){a.__=t}return t};u.focus=function(){try{this.els[this._menuVisible?"yearInput":"focusLink"].focus()}catch(e){}b.call(this)};u.blur=function(){this.els.focusLink.blur();this.els.yearInput.blur();w.call(this)};u.showAt=function(e,t,n){if(this._showAnim){this._showAnim.stop()}n=n&&this.args.animation;var r=this.els.topCont,i=this,s=this.els.body.firstChild,o=s.offsetHeight,u=r.style;u.position="absolute";u.left=e+"px";u.top=t+"px";u.zIndex=1e4;u.display="";if(n){s.style.marginTop=-o+"px";this.args.opacity>1&&st(r,0);this._showAnim=rt({onUpdate:function(e,t){s.style.marginTop=-t(it.accel_b(e),o,0)+"px";i.args.opacity>1&&st(r,e)},onStop:function(){i.args.opacity>1&&st(r,"");i._showAnim=null}})}};u.hide=function(){var e=this.els.topCont,t=this,n=this.els.body.firstChild,r=n.offsetHeight,i=at(e).y;if(this.args.animation){if(this._showAnim){this._showAnim.stop()}this._showAnim=rt({onUpdate:function(s,o){t.args.opacity>1&&st(e,1-s);n.style.marginTop=-o(it.accel_b(s),0,r)+"px";e.style.top=o(it.accel_ab(s),i,i-10)+"px"},onStop:function(){e.style.display="none";n.style.marginTop="";t.args.opacity>1&&st(e,"");t._showAnim=null}})}else{e.style.display="none"}this.inputField=null};u.popup=function(e,t){function u(t){var n={x:a.x,y:a.y};if(!t){return n}if(/B/.test(t)){n.y+=e.offsetHeight}if(/b/.test(t)){n.y+=e.offsetHeight-s.y}if(/T/.test(t)){n.y-=s.y}if(/l/.test(t)){n.x-=s.x-e.offsetWidth}if(/L/.test(t)){n.x-=s.x}if(/R/.test(t)){n.x+=e.offsetWidth}if(/c/i.test(t)){n.x+=(e.offsetWidth-s.x)/2}if(/m/i.test(t)){n.y+=(e.offsetHeight-s.y)/2}return n}e=ht(e);if(!t){t=this.args.align}t=t.split(/\x2f/);var n=at(e),r=this.els.topCont,i=r.style,s,o=ft();i.visibility="hidden";i.display="";this.showAt(0,0);document.body.appendChild(r);s={x:r.offsetWidth,y:r.offsetHeight};var a=n;a=u(t[0]);if(a.y<o.y){a.y=n.y;a=u(t[1])}if(a.x+s.x>o.x+o.w){a.x=n.x;a=u(t[2])}if(a.y+s.y>o.y+o.h){a.y=n.y;a=u(t[3])}if(a.x<o.x){a.x=n.x;a=u(t[4])}this.showAt(a.x,a.y,true);i.visibility="";this.focus()};u.manageFields=function(t,n,r){n=ht(n);$(ht(t),"click",tt(function(){this.inputField=n;this.dateFormat=r;if(this.selection.type==e.SEL_SINGLE){var i,s,o,u;i=/input|textarea/i.test(n.tagName)?n.value:n.innerText||n.textContent;if(i){s=/(^|[^%])%[bBmo]/.exec(r);o=/(^|[^%])%[de]/.exec(r);if(s&&o){u=s.index<o.index}i=Calendar.parseDate(i,u);if(i){this.moveTo(i);this.selection.set(i,false,true)}}}this.popup(t)},this));if(!ie){this.inputField=n;this.dateFormat=r;if(this.selection.type==e.SEL_SINGLE){var i,s,o,u;i=/input|textarea/i.test(n.tagName)?n.value:n.innerText||n.textContent;if(i){s=/(^|[^%])%[bBmo]/.exec(r);o=/(^|[^%])%[de]/.exec(r);if(s&&o){u=s.index<o.index}i=Calendar.parseDate(i,u);if(i){this.moveTo(i);this.selection.set(i,false,true)}}}this.popup(t)}};u.callHooks=function(e){var t=et(arguments,1),n=this.handlers[e],r=0;for(;r<n.length;++r){n[r].apply(this,t)}};u.addEventListener=function(e,t){this.handlers[e].push(t)};u.removeEventListener=function(e,t){var n=this.handlers[e],r=n.length;while(--r>=0){if(n[r]===t){n.splice(r,1)}}};u.getTime=function(){return this.time};u.setTime=function(e,t){if(this.args.showTime){e=this.time=e!=null?e:this.time;var n=this.getHours(),r=this.getMinutes(),i=n<12;if(this.args.showTime==12){if(n==0){n=12}if(n>12){n-=12}this.els.timeAM.innerHTML=j(i?"AM":"PM")}if(n<10){n="0"+n}if(r<10){r="0"+r}this.els.timeHour.innerHTML=n;this.els.timeMinute.innerHTML=r;if(!t){this.callHooks("onTimeChange",this,e)}}};u.getHours=function(){return Math.floor(this.time/100)};u.getMinutes=function(){return this.time%100};u.setHours=function(e){if(e<0){e+=24}this.setTime(100*(e%24)+this.time%100)};u.setMinutes=function(e){if(e<0){e+=60}this.setTime(100*this.getHours()+e%60)};u._getInputYear=function(){var e=parseInt(this.els.yearInput.value,10);if(isNaN(e)){e=this.date.getFullYear()}return e};u._showTooltip=function(e){var t="",n,r=this.els.tooltip;if(e){e=R(e);n=this.args.dateInfo(e);if(n&&n.tooltip){t="<div class='DynarchCalendar-tooltipCont'>"+z(e,n.tooltip)+"</div>"}}r.innerHTML=t};var f=" align='center' cellspacing='0' cellpadding='0'";var g={"DynarchCalendar-topCont":"topCont","DynarchCalendar-focusLink":"focusLink",DynarchCalendar:"main","DynarchCalendar-topBar":"topBar","DynarchCalendar-title":"title","DynarchCalendar-dayNames":"dayNames","DynarchCalendar-body":"body","DynarchCalendar-menu":"menu","DynarchCalendar-menu-year":"yearInput","DynarchCalendar-bottomBar":"bottomBar","DynarchCalendar-tooltip":"tooltip","DynarchCalendar-time-hour":"timeHour","DynarchCalendar-time-minute":"timeMinute","DynarchCalendar-time-am":"timeAM","DynarchCalendar-navBtn DynarchCalendar-prevYear":"navPrevYear","DynarchCalendar-navBtn DynarchCalendar-nextYear":"navNextYear","DynarchCalendar-navBtn DynarchCalendar-prevMonth":"navPrevMonth","DynarchCalendar-navBtn DynarchCalendar-nextMonth":"navNextMonth"};var x={"-3":"backYear","-2":"back",0:"now",2:"fwd",3:"fwdYear"};var D={37:-1,38:-2,39:1,40:2},P={33:-1,34:1};u._getDateDiv=function(e){var t=null;if(e){try{nt(this.els.body,function(n){if(n.getAttribute("dyc-date")==e){throw t=n}})}catch(n){}}return t};(e.Selection=function(e,t,n,r){this.type=t;this.sel=e instanceof Array?e:[e];this.onChange=tt(n,r);this.cal=r}).prototype={get:function(){return this.type==e.SEL_SINGLE?this.sel[0]:this.sel},isEmpty:function(){return this.sel.length==0},set:function(t,n,r){var i=this.type==e.SEL_SINGLE;if(t instanceof Array){this.sel=t;this.normalize();if(!r){this.onChange(this)}}else{t=q(t);if(i||!this.isSelected(t)){i?this.sel=[t]:this.sel.splice(this.findInsertPos(t),0,t);this.normalize();if(!r){this.onChange(this)}}else{if(n){this.unselect(t,r)}}}},reset:function(){this.sel=[];this.set.apply(this,arguments)},countDays:function(){var e=0,t=this.sel,n=t.length,r,i,s;while(--n>=0){r=t[n];if(r instanceof Array){i=R(r[0]);s=R(r[1]);e+=Math.round(Math.abs(s.getTime()-i.getTime())/864e5)}++e}return e},unselect:function(e,t){e=q(e);var n=false;for(var r=this.sel,i=r.length,s;--i>=0;){s=r[i];if(s instanceof Array){if(e>=s[0]&&e<=s[1]){var o=R(e),u=o.getDate();if(e==s[0]){o.setDate(u+1);s[0]=q(o);n=true}else{if(e==s[1]){o.setDate(u-1);s[1]=q(o);n=true}else{var a=new Date(o);a.setDate(u+1);o.setDate(u-1);r.splice(i+1,0,[q(a),s[1]]);s[1]=q(o);n=true}}}}else{if(e==s){r.splice(i,1);n=true}}}if(n){this.normalize();if(!t){this.onChange(this)}}},normalize:function(){this.sel=this.sel.sort(function(e,t){if(e instanceof Array){e=e[0]}if(t instanceof Array){t=t[0]}return e-t});for(var e=this.sel,t=e.length,n,r;--t>=0;){n=e[t];if(n instanceof Array){if(n[0]>n[1]){e.splice(t,1);continue}if(n[0]==n[1]){n=e[t]=n[0]}}if(r){var i=r,s=n instanceof Array?n[1]:n;s=R(s);s.setDate(s.getDate()+1);s=q(s);if(s>=i){var o=e[t+1];if(n instanceof Array&&o instanceof Array){n[1]=o[1];e.splice(t+1,1)}else{if(n instanceof Array){n[1]=r;e.splice(t+1,1)}else{if(o instanceof Array){o[0]=n;e.splice(t,1)}else{e[t]=[n,o];e.splice(t+1,1)}}}}}r=n instanceof Array?n[0]:n}},findInsertPos:function(e){for(var t=this.sel,n=t.length,r;--n>=0;){r=t[n];if(r instanceof Array){r=r[0]}if(r<=e){break}}return n+1},clear:function(e){this.sel=[];if(!e){this.onChange(this)}},selectRange:function(e,t){e=q(e);t=q(t);if(e>t){var n=e;e=t;t=n}this.sel.push([e,t]);this.normalize();this.onChange(this)},isSelected:function(e){for(var t=this.sel.length,n;--t>=0;){n=this.sel[t];if(n instanceof Array&&e>=n[0]&&e<=n[1]||e==n){return true}}return false},getFirstDate:function(){var e=this.sel[0];if(e&&e instanceof Array){e=e[0]}return e},getLastDate:function(){if(this.sel.length>0){var e=this.sel[this.sel.length-1];if(e&&e instanceof Array){e=e[1]}return e}},print:function(e,t){var n=[],r=0,i,s=this.cal.getHours(),o=this.cal.getMinutes();if(!t){t=" -> "}while(r<this.sel.length){i=this.sel[r++];if(i instanceof Array){n.push(z(R(i[0],s,o),e)+t+z(R(i[1],s,o),e))}else{n.push(z(R(i,s,o),e))}}return n},getDates:function(e){var t=[],n=0,r,i;while(n<this.sel.length){i=this.sel[n++];if(i instanceof Array){r=R(i[0]);i=i[1];while(q(r)<i){t.push(e?z(r,e):new Date(r));r.setDate(r.getDate()+1)}}else{r=R(i)}t.push(e?z(r,e):r)}return t}};e.parseDate=function(e,t,n){if(!/\S/.test(e)){return""}e=e.replace(/^\s+/,"").replace(/\s+$/,"");n=n||new Date;var r=null,i=null,s=null,o=null,u=null,a=null;var f=e.match(/([0-9]{1,2}):([0-9]{1,2})(:[0-9]{1,2})?\s*(am|pm)?/i);if(f){o=parseInt(f[1],10);u=parseInt(f[2],10);a=f[3]?parseInt(f[3].substr(1),10):0;e=e.substring(0,f.index)+e.substr(f.index+f[0].length);if(f[4]){if(f[4].toLowerCase()=="pm"&&o<12){o+=12}else{if(f[4].toLowerCase()=="am"&&o>=12){o-=12}}}}var l=e.trim().split(/\W+/);var c=[];for(var h=0;h<l.length;++h){var p=l[h];if(/^[0-9]{4}$/.test(p)){r=parseInt(p,10);if(!i&&!s&&t==null){t=true}}else{if(/^[0-9]{1,2}$/.test(p)){p=parseInt(p,10);if(p>=60){r=p}else{if(p>=0&&p<=12){c.push(p)}else{if(p>=1&&p<=31){s=p}}}}else{i=X(p)}}}if(c.length>=2){if(t){if(!i){i=c.shift()}if(!s){s=c.shift()}}else{if(!s){s=c.shift()}if(!i){i=c.shift()}}}else{if(c.length==1){if(!s){s=c.shift()}else{if(!i){i=c.shift()}}}}if(!r){r=c.length>0?c.shift():n.getFullYear()}if(r<30){r+=2e3}else{if(r<99){r+=1900}}if(!i){i=n.getMonth()+1}return r&&i&&s?new Date(r,i-1,s,o,u,a):null};var it={elastic_b:function(e){return 1-Math.cos(-e*5.5*Math.PI)/Math.pow(2,7*e)},magnetic:function(e){return 1-Math.cos(e*e*e*10.5*Math.PI)/Math.exp(4*e)},accel_b:function(e){e=1-e;return 1-e*e*e*e},accel_a:function(e){return e*e*e},accel_ab:function(e){e=1-e;return 1-Math.sin(e*e*Math.PI/2)},accel_ab2:function(e){return(e/=.5)<1?1/2*e*e:-1/2*(--e*(e-2)-1)},brakes:function(e){e=1-e;return 1-Math.sin(e*e*Math.PI)},shake:function(e){return e<.5?-Math.cos(e*11*Math.PI)*e*e:(e=1-e,Math.cos(e*11*Math.PI)*e*e)}};var ct=new Function;return e}();Calendar.LANG("es","Español",{fdow:1,goToday:"Ir a Hoy",today:"Hoy",wk:"sem",weekend:"0,6",AM:"am",PM:"pm",mn:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],smn:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],dn:["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado","Domingo"],sdn:["Do","Lu","Ma","Mi","Ju","Vi","Sa","Do"]});var cal;var crearXMLHttpRequest=function(){var e;try{e=new XMLHttpRequest;crearXMLHttpRequest=function(){return new XMLHttpRequest}}catch(t){var n=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];for(var r=0,i=n.length;r<i;++r){try{e=new ActiveXObject(n[r]);crearXMLHttpRequest=function(){return new ActiveXObject(n[r])};break}catch(t){}}}return e};var ie=navigator.appName.indexOf("Microsoft")>=0;if(!ie){HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent});HTMLElement.prototype.__defineSetter__("innerText",function(e){this.textContent=e})}String.prototype.startsWith=function(e){return this.match("^"+e)==e};String.prototype.endsWith=function(e){return this.match(e+"$")==e};String.prototype.trim=function(e){return this.replace(/^\s*|\s*$/g,"")};var tagScript="(?:<script.*?>)((\n|\r|.)*?)(?:</script>)";String.prototype.evalScript=function(){return(this.match(new RegExp(tagScript,"img"))||[]).evalScript()};String.prototype.stripScript=function(){return this.replace(new RegExp(tagScript,"img"),"")};String.prototype.extractScript=function(){var e=new RegExp(tagScript,"img");return this.match(e)||[]};Array.prototype.evalScript=function(e){var t=this.map(function(e){var t=(e.match(new RegExp(tagScript,"im"))||["",""])[1];if(window.execScript){try{window.execScript(t)}catch(n){}}else{window.setTimeout(t,0)}});return true};Array.prototype.map=function(e){if(typeof e!=="function"){return false}var t=0,n=this.length;for(t=0;t<n;t++){e(this[t])}return true};Obj=function(e){return document.getElementById(e)};var notificacion